<!DOCTYPE html>
<html>
<head>
    <title>JavaScript virtual machines</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=680, user-scalable=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <link rel="stylesheet" href="shower/themes/ribbon/styles/screen.css">
    <style type="text/css">
        p.annotation {
            margin-bottom:0;
        }
    </style>
</head>
<body class="list">
<header class="caption">
    <h1>JavaScript virtual machines</h1>

    <p><a href="https://twitter.com/krivlenia">Константин Кривленя</a></p>
    <p>Компания <a href="http://www.targetprocess.com/3/">Taucraft</a></p>
</header>
<section class="slide shout">
    <div>
        <h2 style="font-size:100px;">JavaScript virtual machines</h2>
    </div>
</section>
<section class="slide shout">
    <div>
        <h2 >Что такое виртуальная машина?</h2>
    </div>
</section>
<section class="slide shout" >
    <div>
        <p> Виртуальная машина программная и/или аппаратная система, эмулирующая аппаратное обеспечение некоторой платформы (target — целевая, или гостевая платформа) и исполняющая программы для target-платформы на host-платформе (host — хост-платформа, платформа-хозяин)</p>
    </div>
</section>
<section class="slide cover">
    <div>
        <img style="height: 100%;width: 100%;" src="img/jvm.png" alt=""/>
    </div>
</section>
<section class="slide shout">
    <div>
        <h2 >Немного истории</h2>
    </div>
</section>
<section class="slide">
    <div>
        <ul>
            <li >pascal 1970</li>
            <li class="next" >smalltalk 1980</li>
            <li class="next">self 1986</li>
            <li class="next">python 1991</li>
            <li class="next">java 1995</li>
            <li class="next">javascript 1995</li>
        </ul>
    </div>
</section>
<section class="slide">
    <div>
        <h2>Как работает виртуальная машина?</h2>
        <ul>
            <li class="next">Parser</li>
            <li class="next" >Intermediate Representation (IR)</li>
            <li class="next">Interpreter</li>
            <li class="next">Garbage Collection</li>
            <li class="next">Optimization</li>
        </ul>
    </div>
</section>
<section class="slide">
    <div>
        <h2 ><a href="http://esprima.org/demo/parse.html">Parser</a></h2>
        <ul>
            <li class="next">Tokenize</li>
            <li class="next">AST</li>
        </ul>
    </div>
</section>
<section class="slide">
    <div>
        <h2 >Intermediate Representation</h2>
        <ul>
            <li class="next">Bytecode</li>
            <li class="next">Stack vs. register</li>
        </ul>
    </div>
</section>
<section class="slide">
    <div>
        <h2>Stack vs. register</h2>
        <ul>
            <li class="next">Stack: (JVM, .NET, php, python, Old JavaScript engine)</li>
            <li class="next">Register: (Lua, Dalvik, All modern JavaScript engine)</li>
        </ul>
    </div>
</section>
<section class="slide cover">
    <div>
        <img style="height: 100%;width: 100%;" src="img/stvsregister.png" alt=""/>
    </div>
</section>
<section class="slide">
    <div>
        <h2>Garbage Collection</h2>
        <ul>
            <li class="next">Reference counting (php, python ...), smart pointer</li>
            <li class="next">Tracing
                <ul>
                    <li>Stop the world</li>
                    <li>Copying, Mark-and-sweep, Mark-and-compact</li>
                    <li>Generational GC</li>
                    <li>Precise vs. conservative</li>
                </ul>
            </li>
        </ul>
    </div>
</section>

<section class="slide cover">
    <div>
        <img style="height: 100%;width: 100%;" src="img/wallpapers_1235.jpg" alt=""/>
    </div>
</section>
<section class="slide">
    <div>
        <h2>Optimization Magic</h2>
        <ul>
            <li class="next">Interpreter optimization</li>
            <li class="next">Compiler optimization</li>
            <li class="next">JIT</li>
            <li class="next">Type inference</li>
            <li class="next">Hidden classes</li>
            <li class="next">Inline cache</li>
        </ul>
    </div>
</section>
<section class="slide">
    <div>
        <h2>JIT</h2>
        <ul>
            <li class="next">компиляции байт-кода</li>
            <li class="next">динамической компиляции</li>
        </ul>

    </div>
</section>
<section class="slide shout">
    <div>
        <h2 >Type inference</h2>
    </div>
</section>
<section class="slide shout">
    <div>
        <h2 >a + b</h2>
    </div>
</section>
<section class="slide shout">
    <div>
        <h2 >Ожидаю шуточек</h2>
    </div>
</section>
<section class="slide">
    <div>
        <img style="height: 100%;width: 100%;" src="img/ache.png" alt=""/>
    </div>
</section>
<section class="slide shout">
    <div>
        <h2>Hidden classes</h2>
    </div>
</section>
<section class="slide">
    <div><pre>
        <code> function Point(x, y) {</code>
        <code>    this.x = x;</code>
        <code>    this.y = y;</code>
        <code>}</code>
        </pre>
    </div>
</section>
<section class="slide">
    <div><pre>
        <code> function Point(x, y) {</code>
        <code>    this.x = x;</code>
        <code>    this.y = y;</code>
        <code>}</code>
        </pre>
        <img src="img/map_trans_a.png" alt=""/>
    </div>
</section>
<section class="slide">
    <div><pre>
        <code> function Point(x, y) {</code>
        <code>    this.x = x;</code>
        <code>    this.y = y;</code>
        <code>}</code>
        </pre>
        <img src="img/map_trans_b.png" alt=""/>
    </div>
</section>
<section class="slide">
    <div><pre>
        <code> function Point(x, y) {</code>
        <code>    this.x = x;</code>
        <code>    this.y = y;</code>
        <code>}</code>
        </pre>
        <img src="img/map_trans_c.png" alt=""/>
    </div>
</section>
<section class="slide shout">
    <div>
        <h2>Inline cache</h2>
    </div>
</section>
<section class="slide">
    <div>
        For example, the JavaScript code to access property x from a Point object is:
       <pre><code>point.x</code></pre>
        In V8, the machine code generated for accessing x is:
        <pre>
        <code># ebx = the point object</code>
        <code>cmp [ebx, &lt;hidden class offset&gt;],&lt;cached hidden class&gt;</code>
        <code>jne &lt;inline cache miss&gt;</code>
        <code>mov eax,[ebx, &lt;cached x offset&gt;]</code>
         </pre>
    </div>
</section>
<section class="slide shout">
    <div>
        <h2>Результаты</h2>
    </div>
</section>
<section class="slide ">
    <div>

    <a href="https://livoris.de/sites/default/files/images/dromaeo-result.png" title="Dromaeo Score (The higher the better)" class="colorbox init-colorbox-processed cboxElement" rel="gallery-node-65"><img src="img/dromaeo-result1.png" width="431" height="118" alt="" title="Dromaeo Score (The higher the better)"></a>
    <p class="annotation">Dromaeo Score (The higher the better)</p>

    <a href="https://livoris.de/sites/default/files/images/sunspider-result.png" title="SunSpider Runtime (The lower the better)" class="colorbox init-colorbox-processed cboxElement" rel="gallery-node-65"><img src="img/sunspider-result2.png" width="433" height="122" alt="" title="SunSpider Runtime (The lower the better)"></a>
        <p class="annotation">SunSpider Runtime (The lower the better)</p>
    <a href="https://livoris.de/sites/default/files/images/v8bench-result.png" title="V8 Benchmark Suite Score (The higher the better)" class="colorbox init-colorbox-processed cboxElement" rel="gallery-node-65"><img src="img/v8bench-result3.png" width="433" height="123" alt="" title="V8 Benchmark Suite Score (The higher the better)"></a>
        <p class="annotation">V8 Benchmark Suite Score (The higher the better)</p>


    </div>
</section>
<section class="slide">
    <div>
        <h2>V8</h2>
        <ul>
            <li class="next">Lars Bak</li>
            <li class="next">Hidden Class,Inline cache</li>
            <li class="next">Precise generation GC</li>
        </ul>
    </div>
</section>
<section class="slide">
    <div>
        <h2>Lars Bak</h2>
        <ul>
            <li class="next">implement VM since 1988</li>
            <li class="next">Beta</li>
            <li class="next">Self</li>
            <li class="next">HotSpot</li>
        </ul>
        <img src="img/lars1_01.jpg" alt="" style="
    position: absolute;
    display: block;
    top: 100px;
    right: 308px;
">
    </div>
</section>
<section class="slide">
    <div>
        <h2>Еще движки</h2>
        <ul>
            <li class="next">JavaScriptCore (Nitro)</li>
            <li class="next">SipderMonkey</li>
            <li class="next">Chakra</li>
            <li class="next">Carakan</li>
            <li class="next">Rhino and JVM</li>
        </ul>
    </div>
</section>
<section class="slide shout">
    <div>
        <h2>Rhino is SLOW, why?</h2>
    </div>
</section>
<section class="slide cover">
    <div>
        <img style="position: static;vertical-align: middle;display: inline-block;text-align: center;height: 100%;" src="img/dog.png" alt="">
    </div>
</section>
<section class="slide shout">
    <div>
        <h2>Solution: invokedynamic</h2>
    </div>
</section>
<section class="slide shout">
    <div>
        <h2>Вопросы?</h2>        
    </div>
</section>
<section class="slide">
    <div>
        <h2>Контакты</h2>
        <a style="background:url(img/twitter-bird-light-bgs.png) no-repeat;padding-left:40px;" href="https://twitter.com/Krivlenia">Twitter (https://twitter.com/Krivlenia/)</a><br>
        <a style="background:url(img/GitHub-Mark-32px.png) no-repeat;padding-left:40px;" href="https://github.com/Mavrin">Github (https://github.com/Mavrin/)</a><br>
        <a style="background:url(img/habrahabr.png) center left no-repeat;padding-left:20px;" href="http://habrahabr.ru/users/mavrin/">Хабр (http://habrahabr.ru/users/mavrin/)</a><br>
    </div>
</section>

<div class="progress">
    <div></div>
</div>
<script src="shower/shower.min.js"></script>
</body>
</html>